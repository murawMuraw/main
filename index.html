<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Прозрачный круг в затемнённой карте</title>
  <script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU"></script>
  <style>
    html, body, #map {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
    }
  </style>
</head>
<body>
  <div id="map"></div>
  <script>
    ymaps.ready(function () {
      const center = [51.5, 0.0]; // Гринвич
      const radiusMeters = 15000; // 15 км

      const map = new ymaps.Map("map", {
        center: center,
        zoom: 10
      });

      // Функция генерации круга с координатами
      function createCircleCoords(center, radius, points) {
        const coords = [];
        const lat = center[0] * Math.PI / 180;
        const lon = center[1] * Math.PI / 180;
        const earthRadius = 6378137;

        for (let i = 0; i <= points; i++) {
          const angle = 2 * Math.PI * i / points;
          const dx = radius * Math.cos(angle);
          const dy = radius * Math.sin(angle);

          const latOffset = (dy / earthRadius) * (180 / Math.PI);
          const lonOffset = (dx / (earthRadius * Math.cos(lat))) * (180 / Math.PI);

          coords.push([center[0] + latOffset, center[1] + lonOffset]);
        }

        return coords;
      }

      // Координаты всей карты
      const outerBounds = [
        [85, -179.999],
        [85, 179.999],
        [-85, 179.999],
        [-85, -179.999],
        [85, -179.999] // замыкаем контур
      ];

      // Координаты "отверстия"
      const hole = createCircleCoords(center, radiusMeters, 100);

      const polygon = new ymaps.Polygon([outerBounds, hole], {}, {
        fillColor: 'rgba(0, 0, 0, 0.5)',
        strokeWidth: 0
      });

      map.geoObjects.add(polygon);
    });
  </script>
</body>
</html>



